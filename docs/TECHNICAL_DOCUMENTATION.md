# 📚 技术文档

## 🏗️ 系统架构

### 核心组件
- **signal_mapper_gui.py**: 主GUI程序，图形界面和用户交互
- **signal_mapper.py**: 核心信号分析算法
- **generate_amap_html.py**: 地图HTML生成器
- **config_template.py**: 配置文件模板

### 技术栈
- **后端**: Python 3.7+ + Tkinter + HTTP Server
- **前端**: HTML5 + CSS3 + JavaScript + 高德地图API
- **数据处理**: Pandas + OpenPyXL + XLSX.js
- **系统监控**: psutil + logging

## 🚀 核心功能

### 1. 一键启动服务
自动执行完整的服务启动流程：
1. **系统检查**: 验证Python环境和依赖包
2. **数据准备**: 生成示例数据或验证用户数据
3. **服务启动**: 启动HTTP服务器，自动选择可用端口
4. **浏览器打开**: 自动打开默认浏览器显示地图

### 2. 智能数据分析
- **K-means聚类**: 自动将监测点按地理位置分组
- **信号预测**: 使用IDW插值算法预测未监测区域信号强度
- **盲区检测**: 基于凸包算法识别信号覆盖盲区
- **统计分析**: 多维度信号质量评估和覆盖率统计

### 3. 可视化展示
- **热力图**: 基于聚类的区域信号强度分布
- **标记点**: 不同颜色和大小表示信号强度等级
- **交互控制**: 热力图开关、信号筛选、图层管理
- **统计面板**: 实时显示监测点概况和质量指标

### 4. 诊断工具
- **系统检测**: 自动检查运行环境和依赖状态
- **日志系统**: 五级日志记录，文件和GUI双输出
- **错误分析**: 智能异常诊断，提供针对性解决方案
- **端口管理**: 自动检测和选择可用端口

## 📊 数据格式规范

### Excel文件要求
| 字段名 | 数据类型 | 示例值 | 备注 |
|--------|----------|--------|------|
| 位置描述 | 文本 | 南通市崇川区南大街 | 必填，监测点名称 |
| 详细地址 | 文本 | 江苏省南通市崇川区南大街128号 | 必填，用于地理编码 |
| 网络类型 | 文本 | 5G | 可选，网络制式 |
| 信号强度 | 数值 | 8 | 必填，1-10分评分 |
| 上报时间 | 日期时间 | 2024-01-15 10:30 | 可选，数据采集时间 |
| 上报人 | 文本 | 张三 | 可选，采集人员 |
| 备注 | 文本 | 地下商场信号较弱 | 可选，补充说明 |

### 信号强度评分标准
- **9-10分**: 信号优秀，通信流畅
- **7-8分**: 信号良好，基本满足需求
- **5-6分**: 信号一般，可能有轻微影响
- **3-4分**: 信号较差，通信不稳定
- **1-2分**: 信号盲区，无法正常通信

## 🔧 配置说明

### API密钥配置
编辑 `config_template.py` 文件，填入你的高德地图API密钥：

```python
# 高德地图API配置
AMAP_WEB_API_KEY = "your_web_api_key_here"
AMAP_JS_API_KEY = "your_js_api_key_here"
```

### 环境变量配置
也可以使用环境变量：
```bash
export AMAP_WEB_API_KEY="your_web_api_key"
export AMAP_JS_API_KEY="your_js_api_key"
```

## 🛠️ 故障排除

### 常见问题

#### 程序启动失败
**可能原因**: Python环境或依赖包问题
**解决方案**:
1. 确认Python版本 >= 3.7
2. 安装依赖: `pip install -r requirements.txt`
3. 以管理员身份运行程序

#### 服务器无法启动
**可能原因**: 端口被占用或权限不足
**解决方案**:
1. 程序会自动尝试8888-8999端口
2. 关闭占用端口的其他程序
3. 检查防火墙设置

#### 浏览器未自动打开
**可能原因**: 浏览器设置或权限问题
**解决方案**:
1. 手动访问程序显示的URL地址
2. 点击GUI中的"打开网页"按钮
3. 检查默认浏览器设置

#### 地图无法显示
**可能原因**: 网络连接或API密钥问题
**解决方案**:
1. 检查网络连接是否正常
2. 确认API密钥配置正确
3. 检查API密钥的配额和权限

#### Excel文件导入失败
**可能原因**: 文件格式或数据内容问题
**解决方案**:
1. 确认文件为.xlsx或.xls格式
2. 检查必填字段是否存在
3. 参考示例数据格式调整

### 诊断工具

程序内置完整的诊断系统，遇到问题时可以：
1. 点击"系统检查"查看环境状态
2. 开启"调试模式"查看详细日志
3. 使用"导出日志"功能生成诊断报告

## 📈 性能优化

### 系统要求
- **最低**: Python 3.7+, 2GB RAM, 500MB磁盘空间
- **推荐**: Python 3.9+, 4GB RAM, 1GB磁盘空间

### 数据限制
- Excel文件大小: 建议不超过20MB
- 监测点数量: 建议不超过10,000个点
- 浏览器: 推荐Chrome 90+或Firefox 88+

### 网络要求
- 需要访问互联网（加载高德地图）
- 本地回环地址访问权限
- 防火墙允许8888-8999端口

## 🔐 安全注意事项

### API密钥安全
- 不要将API密钥提交到版本控制系统
- 定期轮换API密钥
- 为API密钥设置适当的权限和配额限制

### 数据安全
- 上传的Excel文件仅在本地处理，不会发送到远程服务器
- 生成的地图文件仅保存在本地
- 建议定期清理临时文件和日志

### 网络安全
- HTTP服务器仅绑定本地地址(localhost)
- 不建议在生产环境直接暴露服务
- 建议在受信任的网络环境中使用

## 📞 技术支持

### 问题反馈
- GitHub Issues: 项目主页的Issues页面
- 日志文件: 查看 `signal_mapper.log` 文件
- 诊断报告: 使用程序的"导出日志"功能

### 社区支持
- 详细文档: 查看项目README和文档
- 示例代码: 参考项目源代码注释
- 最佳实践: 查看CONTRIBUTING.md文档 